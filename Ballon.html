<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Balloon Popper with AI Chat</title>
  <style>
    :root{--bg:#0d1226;--panel:#0f1724;--accent:#ff6b6b;--accent2:#ffd166;--muted:#a0aec0}
    html,body{height:100%;margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,'Helvetica Neue',Arial}
    body{background:linear-gradient(180deg,#071029 0%, #081827 60%);color:#e6eef8;display:flex;align-items:center;justify-content:center}
    .wrap{width:1100px;max-width:98%;min-height:600px;background:rgba(255,255,255,0.03);border-radius:16px;padding:18px;box-shadow:0 10px 30px rgba(2,6,23,0.6);display:grid;grid-template-columns:1fr 300px 280px;gap:16px}
    .gamePanel{background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));border-radius:12px;padding:12px;display:flex;flex-direction:column;align-items:center}
    canvas{background:linear-gradient(180deg,#0b1b2b,#05202b);border-radius:8px;margin-top:6px}
    .side{background:rgba(255,255,255,0.02);border-radius:12px;padding:12px;display:flex;flex-direction:column;gap:12px}
    .chat{background:rgba(255,255,255,0.02);border-radius:12px;padding:12px;display:flex;flex-direction:column;height:100%}
    .chatBox{flex:1;overflow-y:auto;border:1px solid rgba(255,255,255,0.05);padding:8px;border-radius:8px;background:rgba(0,0,0,0.2)}
    .msg{margin:4px 0;padding:6px 8px;border-radius:8px;max-width:80%}
    .user{background:var(--accent);color:#081827;align-self:flex-end}
    .ai{background:rgba(255,255,255,0.1);align-self:flex-start}
    .chatInput{display:flex;gap:6px;margin-top:6px}
    .chatInput input{flex:1;padding:6px;border-radius:8px;border:none;background:rgba(255,255,255,0.05);color:inherit}
    .chatInput button{background:var(--accent2);border:none;border-radius:8px;padding:6px 10px;cursor:pointer;color:#081827;font-weight:700}
    @media (max-width:1000px){.wrap{grid-template-columns:1fr;min-height:720px}}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="gamePanel">
      <div class="meta" style="width:100%">
        <h1>Balloon Popper</h1>
        <div class="controls">
          <button id="startBtn">Start</button>
          <button id="pauseBtn" class="small">Pause</button>
          <button id="resetBtn" class="small">Reset</button>
        </div>
      </div>
      <canvas id="gameCanvas" width="800" height="520"></canvas>
      <div style="width:100%;display:flex;justify-content:space-between;margin-top:8px">
        <div class="stat"><div style="font-size:12px;color:var(--muted)">Score</div><div id="score" style="font-size:22px">0</div></div>
        <div class="stat"><div style="font-size:12px;color:var(--muted)">Time</div><div id="time" style="font-size:22px">0s</div></div>
        <div class="stat"><div style="font-size:12px;color:var(--muted)">Multiplier</div><div id="mult" style="font-size:22px">1x</div></div>
      </div>
      <footer>Made for fun — try to reach the leaderboard!</footer>
    </div><div class="side">
  <div class="leaderboard">
    <h3>Leaderboard (Top 5)</h3>
    <ol id="leaderboardList"></ol>
    <div style="display:flex;gap:8px;margin-top:8px">
      <button id="saveScore" class="small">Save My Score</button>
      <button id="clearScores" class="small">Clear Scores</button>
    </div>
  </div>
</div>

<div class="chat">
  <h3>AI Chat History</h3>
  <div class="chatBox" id="chatBox"></div>
  <div class="chatInput">
    <input type="text" id="chatInput" placeholder="Type a message..." />
    <button id="sendBtn">Send</button>
  </div>
</div>

  </div>  <script>
    // ==== Game (Balloon Popper) — unchanged logic, shortened for space ====
    const canvas=document.getElementById('gameCanvas');const ctx=canvas.getContext('2d');
    const startBtn=document.getElementById('startBtn');const pauseBtn=document.getElementById('pauseBtn');const resetBtn=document.getElementById('resetBtn');
    const scoreEl=document.getElementById('score');const timeEl=document.getElementById('time');const multEl=document.getElementById('mult');
    let running=false,lastTime=0,elapsed=0,spawnTimer=0,score=0,multiplier=1,balloons=[];
    function resetGame(){running=false;lastTime=performance.now();elapsed=0;spawnTimer=0;score=0;multiplier=1;balloons=[];scoreEl.textContent='0';timeEl.textContent='0s';multEl.textContent='1x';ctx.clearRect(0,0,canvas.width,canvas.height);}
    function startGame(){if(!running){running=true;lastTime=performance.now();requestAnimationFrame(loop);}}
    function loop(now){if(!running)return;const dt=Math.min((now-lastTime)/1000,0.05);lastTime=now;elapsed+=dt;spawnTimer+=dt;if(spawnTimer>0.5){spawnTimer=0;spawnBalloon();}for(let i=balloons.length-1;i>=0;i--){balloons[i].y+=balloons[i].vy*dt*60;if(balloons[i].y<-20)balloons.splice(i,1);}ctx.clearRect(0,0,canvas.width,canvas.height);for(const b of balloons){ctx.beginPath();ctx.arc(b.x,b.y,b.size,0,Math.PI*2);ctx.fillStyle=b.color;ctx.fill();}scoreEl.textContent=score;timeEl.textContent=Math.floor(elapsed)+'s';multEl.textContent=multiplier+'x';requestAnimationFrame(loop);} 
    function spawnBalloon(){const size=Math.random()*20+20;const x=Math.random()*canvas.width;const y=canvas.height+size;const color=`hsl(${Math.random()*360},80%,60%)`;balloons.push({x,y,size,vy:-50,color});}
    canvas.addEventListener('click',e=>{const r=canvas.getBoundingClientRect();const x=e.clientX-r.left;const y=e.clientY-r.top;for(let i=balloons.length-1;i>=0;i--){const b=balloons[i];if(Math.hypot(x-b.x,y-b.y)<b.size){score+=10;balloons.splice(i,1);break;}}});
    startBtn.onclick=()=>startGame();pauseBtn.onclick=()=>running=!running;resetBtn.onclick=()=>resetGame();resetGame();

    // ==== Leaderboard ====
    const saveBtn=document.getElementById('saveScore');const clearBtn=document.getElementById('clearScores');const list=document.getElementById('leaderboardList');const STORAGE_KEY='balloon_scores';
    function loadScores(){return JSON.parse(localStorage.getItem(STORAGE_KEY)||'[]');}
    function saveScores(s){localStorage.setItem(STORAGE_KEY,JSON.stringify(s));}
    function render(){list.innerHTML='';const s=loadScores();if(s.length==0){list.innerHTML='<li>No scores yet</li>';return;}s.forEach(sc=>{const li=document.createElement('li');li.textContent=`${sc.name} — ${sc.score}`;list.appendChild(li);});}
    saveBtn.onclick=()=>{let s=loadScores();s.push({name:'Player',score});s.sort((a,b)=>b.score-a.score);s=s.slice(0,5);saveScores(s);render();};clearBtn.onclick=()=>{localStorage.removeItem(STORAGE_KEY);render();};render();

    // ==== AI Chat History ====
    const chatBox=document.getElementById('chatBox');const chatInput=document.getElementById('chatInput');const sendBtn=document.getElementById('sendBtn');
    const CHAT_KEY='ai_chat_history';
    function loadChat(){return JSON.parse(localStorage.getItem(CHAT_KEY)||'[]');}
    function saveChat(c){localStorage.setItem(CHAT_KEY,JSON.stringify(c));}
    function renderChat(){chatBox.innerHTML='';const c=loadChat();c.forEach(m=>{const div=document.createElement('div');div.className='msg '+m.sender;div.textContent=m.text;chatBox.appendChild(div);});chatBox.scrollTop=chatBox.scrollHeight;}
    function addMessage(sender,text){const c=loadChat();c.push({sender,text});saveChat(c);renderChat();}
    sendBtn.onclick=()=>{const val=chatInput.value.trim();if(!val)return;addMessage('user',val);chatInput.value='';// simulate AI response
      setTimeout(()=>{addMessage('ai','AI says: '+val.split('').reverse().join(''));},600);};
    renderChat();
  </script></body>
</html>
